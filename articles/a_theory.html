<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="jointCalib">
<title>Joint calibration estimators for totals and quantiles • jointCalib</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Joint calibration estimators for totals and quantiles">
<meta property="og:description" content="jointCalib">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jointCalib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_theory.html">Joint calibration estimators for totals and quantiles</a>
    <a class="dropdown-item" href="../articles/b_survey.html">Calibration of quantiles and a joint calibration of totals and quanitles for surveys</a>
    <a class="dropdown-item" href="../articles/c_nonprob.html">Calibration and inverse probability weighting for non-probability samples</a>
    <a class="dropdown-item" href="../articles/d_causal.html">Balancing distributions for observational studies</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ncn-foreigners/jointCalib/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Joint calibration estimators for totals and quantiles</h1>
                        <h4 data-toc-skip class="author">Maciej
Beręsewicz and Marcin Szymkowiak</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/jointCalib/blob/HEAD/vignettes/a_theory.Rmd" class="external-link"><code>vignettes/a_theory.Rmd</code></a></small>
      <div class="d-none name"><code>a_theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Calibration weighting is a method commonly used in survey sampling to
adjust original design weights for sampled elements to reproduce known
population totals for all auxiliary variables <span class="citation">(<a href="#ref-deville1992calibration" role="doc-biblioref">Deville and
Särndal 1992</a>)</span>. Following the calibration paradigm, it can
also be used to reproduce known population quantiles for all benchmark
variables <span class="citation">(<a href="#ref-harms2006calibration" role="doc-biblioref">Harms and Duchesne 2006</a>)</span>. This technique
is also used in surveys to compensate for nonsampling errors, such as
nonresponse or coverage errors <span class="citation">(<a href="#ref-sarndal2005estimation" role="doc-biblioref">Särndal and
Lundström 2005</a>)</span>. By appropriately adjusting the weights, it
is not only possible to ensure consistency with known structures for key
variables from other data sources, such as censuses or registers, but
also to reduce the bias and improve the precision of final estimates.
%Calibration weighting is also used in surveys in which the analysed
features have asymmetric distributions (in the presence of outliers) to
compensate for their negative impact on the final estimates: calibration
weights provide robustness while meeting constraints on the calibration
variables and the weights <span class="citation">(<a href="#ref-duchesne1999robust" role="doc-biblioref">Duchesne
1999</a>)</span>.</p>
<p>In this article, we propose a joint calibration approach to estimate
the total or quantile of order <span class="math inline">\(\alpha\)</span> for the variable of interest <span class="math inline">\(y\)</span>. Final calibration weights <span class="math inline">\(w_{k}\)</span> reproduce known population totals
and quantiles for all auxiliary variables. At the same time, they help
to reduce the bias and improve the precision of estimates. The proposed
method is based on the classic approach to calibration and
simultaneously takes into account calibration equations for totals and
quantiles of all auxiliary variables.</p>
<!-- 
The paper has the following structure. In section \ref{sec-basic} we introduce the basic setup: notation, calibration for totals and quantiles. In section \ref{sec-proposed} we describe the procedure of joint calibration of totals and quantiles. In section \ref{sec-sims} we describe results of a simulation study based on \citet{chen2020doubly}. Section \ref{sec-summary} summarises the paper. 
-->
</div>
<div class="section level2">
<h2 id="calibration-estimator-for-a-total">Calibration estimator for a total<a class="anchor" aria-label="anchor" href="#calibration-estimator-for-a-total"></a>
</h2>
<p>In most applications the goal is to estimate a finite population
total <span class="math inline">\(\tau_{y}=\sum_{k\in U}y_{k}\)</span>
or the mean <span class="math inline">\(\bar{\tau}_{y}=\tau_{y}/N\)</span> of the variable
of interest <span class="math inline">\(y\)</span>, where <span class="math inline">\(U\)</span> is the population of size <span class="math inline">\(N\)</span>. The well-known estimator of a finite
population total is the Horvitz-Thompson estimator, which is expressed
as <span class="math inline">\(\hat{\tau}_{y\pi}=\sum_{k=1}^{n}d_{k}y_{k}=\sum_{k\in
s}{d_{k}y_{k}}\)</span>, where <span class="math inline">\(s\)</span>
denotes a probability sample of size <span class="math inline">\(n\)</span>, <span class="math inline">\(d_{k}=1/\pi_{k}\)</span> is a design weight and
<span class="math inline">\(\pi_{k}\)</span> is the first-order
inclusion probability of the <span class="math inline">\(i\)</span>-th
element of the population <span class="math inline">\(U\)</span>. This
estimator is unbiased for <span class="math inline">\(\tau_{Y}\)</span>
i.e. <span class="math inline">\(E\left(\hat{\tau}_{y\pi}\right)=\tau_{Y}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{x}_{k}^{\circ}\)</span> be a
<span class="math inline">\(J_{1}\)</span>-dimensional vector of
auxiliary variables (benchmark variables) for which <span class="math inline">\(\tau_{\mathbf{x}}=\sum_{k\in
U}\mathbf{x}_{k}^{\circ}=\left(\sum_{k\in U}x_{k1},\ldots,\sum_{k\in
U}x_{kJ_{1}}\right)^T\)</span> is assumed to be known. In most cases in
practice the <span class="math inline">\(d_{k}\)</span> weights do not
reproduce known population totals for benchmark variables <span class="math inline">\(\mathbf{x}_{k}^{\circ}\)</span>. It means that the
resulting estimate <span class="math inline">\(\hat{\tau}_{\mathbf{x}\pi}=\sum_{k\in
s}{d_{k}\mathbf{x}_{k}^{\circ}}\)</span> is not equal to <span class="math inline">\(\tau_{\mathbf{x}}\)</span>. The main idea of
calibration is to look for new calibration weights <span class="math inline">\(w_{k}\)</span> which are as close as possible to
original design weights <span class="math inline">\(d_{k}\)</span> and
reproduce known population totals <span class="math inline">\(\tau_{\mathbf{x}}\)</span> exactly. In other
words, in order to find new calibration weights <span class="math inline">\(w_{k}\)</span> we have to minimise a distance
function <span class="math inline">\(D\left(\mathbf{d},\mathbf{v}\right)=\sum _{k\in
s}d_{k}\hspace{2pt} G\hspace{0pt}\left(\frac{v_{k}}{d_{k}}\right) \to
\textrm{min}\)</span> to fulfil calibration equations <span class="math inline">\(\sum_{k\in s}v_{k}\mathbf{x}_{k}^{\circ} =
\sum_{k\in U}\mathbf{x}_{k}^{\circ}\)</span>, where <span class="math inline">\(\mathbf{d}=\left(d_{1},\ldots,d_{n}\right)^T\)</span>,
<span class="math inline">\(\mathbf{v}=\left(v_{1},\ldots,v_{n}\right)^T\)</span>
and <span class="math inline">\(G\left(\cdot\right)\)</span> is a
function which must satisfy some regularity conditions: <span class="math inline">\(G\left(\cdot\right)\)</span> is strictly convex
and twice continuously differentiable, <span class="math inline">\(G\left(\cdot\right)\geq 0\)</span>, <span class="math inline">\(G\left(1\right)=0\)</span>, <span class="math inline">\(G'\left(1\right)=0\)</span> and <span class="math inline">\(G''\left(1\right)=1\)</span>. Examples of
<span class="math inline">\(G\left(\cdot\right)\)</span> functions are
given by <span class="citation">Deville and Särndal (<a href="#ref-deville1992calibration" role="doc-biblioref">1992</a>)</span>. For instance, if <span class="math inline">\(G\left(x\right)=\frac{\left(x-1\right)^{2}}{2}\)</span>,
then using the method of Lagrange multipliers the final calibration
weights <span class="math inline">\(w_{k}\)</span> can be expressed as
<span class="math inline">\(w_{k}=d_{k}+d_{k}\left(\tau_{\mathbf{x}}-\hat{\tau}_{\mathbf{x}\pi}\right)^T\left(\sum_{j\in
s}d_{j}\mathbf{x}_{j}^{\circ}\mathbf{x}_{j}^{\circ
T}\right)^{-1}\mathbf{x}_{k}^{\circ}\)</span>. It is worth adding that
in order to avoid negative or large <span class="math inline">\(w_{k}\)</span> weights in the process of
minimising the <span class="math inline">\(D\left(\cdot\right)\)</span>
function, one can consider some boundary constraints <span class="math inline">\(L\leq \frac{w_{k}}{d_{k}}\leq U\)</span>, where
<span class="math inline">\(\ 0\leq L\leq 1 \leq
U,\  k=1,\ldots,n\)</span>. The final calibration estimator of a
population total <span class="math inline">\(\tau_{y}\)</span> can be
expressed as <span class="math inline">\(\hat{\tau}_{y\mathbf{x}}=\sum_{k\in
s}w_{k}y_{k}\)</span>, where <span class="math inline">\(w_{k}\)</span>
are calibration weights obtained under a specific chosen <span class="math inline">\(G\left(\cdot\right)\)</span> function.</p>
</div>
<div class="section level2">
<h2 id="calibration-estimator-for-a-quantile">Calibration estimator for a quantile<a class="anchor" aria-label="anchor" href="#calibration-estimator-for-a-quantile"></a>
</h2>
<p><span class="citation">Harms and Duchesne (<a href="#ref-harms2006calibration" role="doc-biblioref">2006</a>)</span>
considered the estimation of quantiles using the calibration approach in
a way very similar to the what <span class="citation">Deville and
Särndal (<a href="#ref-deville1992calibration" role="doc-biblioref">1992</a>)</span> proposed for a finite population
total <span class="math inline">\(\tau_{y}\)</span>. By analogy, in
their approach it is not necessary to know values for all auxiliary
variables for all units in the population. It is enough to know the
corresponding quantiles for the benchmark variables. We will briefly
discuss the problem of finding calibration weights in this setup.</p>
<p>We want to estimate a quantile <span class="math inline">\(Q_{y,\alpha}\)</span> of order <span class="math inline">\(\alpha \in \left(0,1\right)\)</span> of the
variable of interest <span class="math inline">\(y\)</span>, which can
be expressed as <span class="math inline">\(Q_{y,\alpha}=\mathrm{inf}\left\{t\left|F_{y}\left(t\right)\geq
\alpha \right.\right\}\)</span>, where <span class="math inline">\(F_{y}\left(t\right)=N^{-1}\sum_{k\in
U}H\left(t-y_{k}\right)\)</span> and the Heavyside function is given
by</p>
<p><span class="math display">\[\begin{equation}\label{eq:H}
H\left(t-y_{k}\right)=\left\{ \begin{array}{ll}
1, &amp; \ t \geq y_{k},\\
0, &amp; \ t&lt;y_{k}.\\
\end{array} \right.
\end{equation}\]</span></p>
<p>We assume that <span class="math inline">\(\mathbf{Q}_{\mathbf{x},\alpha}=\left(Q_{x_{1},\alpha},\ldots,Q_{x_{J_{2}},\alpha}\right)^{T}\)</span>
is a vector of known population quantiles of order <span class="math inline">\(\alpha\)</span> for a vector of auxiliary
variables <span class="math inline">\(\mathbf{x}_{k}^{*}\)</span>, where
<span class="math inline">\(\alpha \in \left(0,1\right)\)</span> and
<span class="math inline">\(\mathbf{x}_{k}^{*}\)</span> is a <span class="math inline">\(J_{2}\)</span>-dimensional vector of auxiliary
variables. It is worth noting that, in general, the numbers <span class="math inline">\(J_{1}\)</span> and <span class="math inline">\(J_{2}\)</span> of the auxiliary variables are
different. It may happen that for a specific auxiliary variable its
population total and the corresponding quantile of order <span class="math inline">\(\alpha\)</span> will be known. However, in most
cases quantiles will be known for continuous auxiliary variables, unlike
totals, which will generally be known for categorical variables. In
order to find new calibration weights <span class="math inline">\(w_{k}\)</span> which reproduce known population
quantiles in a vector <span class="math inline">\(Q_{\mathbf{x},\alpha}\)</span>, an interpolated
distribution function estimator of <span class="math inline">\(F_{y}\left(t\right)\)</span> is defined as <span class="math inline">\(\hat{F}_{y,cal}(t)=\frac{\sum_{k \in s} w_{k}
H_{y, s}\left(t, y_{k}\right)}{\sum_{k \in s} w_{k}}\)</span>, where the
Heavyside function in formula (<span class="math inline">\(\ref{eq:H}\)</span>) is replaced by the modified
function <span class="math inline">\(H_{y, s}\left(t,
y_{k}\right)\)</span> given by</p>
<p><span class="math display">\[\begin{equation}
H_{y, s}\left(t, y_{k}\right)=\left\{
\begin{array}{ll}
1, &amp; y_{k} \leqslant L_{y, s}(t), \\
\beta_{y, s}\left(t\right), &amp; y_{k}=U_{y, s}\left(t\right), \\
0, &amp; y_{k}&gt;U_{y, s}\left(t\right),
\end{array}\right.
\end{equation}\]</span></p>
<p>where <span class="math inline">\(L_{y, s}\left(t\right)=\max
\left\{\left\{y_{k}, k \in s \mid y_{k} \leqslant t\right\}
\cup\{-\infty\}\right\}\)</span>, <span class="math inline">\(U_{y,
s}\left(t\right)=\min \left\{\left\{y_{k}, k \in s \mid
y_{k}&gt;t\right\} \cup\{\infty\}\right\}\)</span> and <span class="math inline">\(\beta_{y, s}\left(t\right)=\frac{t-L_{y,
s}\left(t\right)}{U_{y, s}\left(t\right)-L_{y,
s}\left(t\right)}\)</span> for <span class="math inline">\(k=1,\ldots,n\)</span>, <span class="math inline">\(t \in \mathbb{R}\)</span>. A calibration estimator
of quantile <span class="math inline">\(Q_{y,\alpha}\)</span> of order
<span class="math inline">\(\alpha\)</span> for variable <span class="math inline">\(y\)</span> is defined as <span class="math inline">\(\hat{Q}_{y,cal,\alpha}=\hat{F}_{y,cal}^{-1}(\alpha)\)</span>,
where a vector <span class="math inline">\(\mathbf{w}=\left(w_{1},\ldots,w_{n}\right)^{T}\)</span>
is a solution of optimization problem <span class="math inline">\(D\left(\mathbf{d},\mathbf{v}\right)=\sum _{k\in
s}d_{k}\hspace{2pt} G\hspace{0pt}\left(\frac{v_{k}}{d_{k}}\right) \to
\textrm{min}\)</span> subject to the calibration constraints <span class="math inline">\(\sum_{k\in s}v_{k}=N\)</span> and <span class="math inline">\(\hat{\mathbf{Q}}_{\mathbf{x},cal,\alpha}=\left(\hat{Q}_{x_{1},cal,\alpha},\ldots,\hat{Q}_{x_{J_{2}},cal,\alpha}\right)^{T}=\mathbf{Q}_{\mathbf{x},\alpha}\)</span>
or equivalently <span class="math inline">\(\hat{F}_{x_{j},cal}\left(Q_{x_{j},\alpha}\right)=\alpha\)</span>,
where <span class="math inline">\(j=1,\ldots,J_{2}\)</span>.</p>
<p>As in the previous case, if <span class="math inline">\(G\left(x\right)=\frac{\left(x-1\right)^{2}}{2}\)</span>
then using the method of Lagrange multipliers the final calibration
weights <span class="math inline">\(w_{k}\)</span> can be expressed as
<span class="math inline">\(w_{k}=d_{k}+d_{k}\left(\mathbf{T_{a}}-\sum_{k\in
s}{d_{k}\mathbf{a}_{k}}\right)^{T}\left(\sum_{j\in
s}{d_{j}}\mathbf{a}_{j}\mathbf{a}_{j}^{T}\right)^{-1}\mathbf{a}_{k}\)</span>,
where <span class="math inline">\(\mathbf{T_{a}}=\left(N,\alpha,\ldots,\alpha\right)^{T}\)</span>
and the elements of <span class="math inline">\(\mathbf{a}_{k}=\left(1,a_{k1},\ldots,a_{kJ_{2}}\right)^{T}\)</span>
are given by</p>
<p><span class="math display">\[\begin{equation}
a_{kj}=\left\{\begin{array}{lll}
N^{-1},&amp; \quad x_{kj}\leq
L_{x_{j},s}\left(Q_{x_{j},\alpha}\right),\\
N^{-1}\beta_{x_{j},s}\left(Q_{x_{j},\alpha}\right), &amp; \quad
x_{kj}=U_{x_{j},s}\left(Q_{x_{j},\alpha}\right),\\
0,&amp; \quad x_{kj}&gt; U_{x_{j},s}\left(Q_{x_{j},\alpha}\right),\\
\end{array} \right.
\end{equation}\]</span></p>
<p>with <span class="math inline">\(j=1,\ldots,J_{2}\)</span>.</p>
<p>Assuming that <span class="math inline">\(y_{1}\leq y_{2}\ldots \leq
y_{n}\)</span> it can be shown that if there exists <span class="math inline">\(p\!\in\!\!{\left\{1,\ldots,n-1\right\}}\)</span>
such that <span class="math inline">\(\hat{F}_{y,cal}\left(y_{p}\right)\leq
\alpha\)</span>, <span class="math inline">\(\hat{F}_{y,cal}\left(y_{p+1}\right)&gt;
\alpha\)</span> and <span class="math inline">\(\hat{F}_{y,cal}\)</span>
is invertible at point <span class="math inline">\(\hat{Q}_{y,cal,\alpha}\)</span> then the
calibration estimator <span class="math inline">\(\hat{Q}_{y,cal,\alpha}\)</span> of quantile <span class="math inline">\(Q_{y,\alpha}\)</span> of order <span class="math inline">\(\alpha \in \left(0,1\right)\)</span> can be
expressed as <span class="math inline">\(\hat{Q}_{y,cal,\alpha}=y_{p}+\frac{N\alpha-\sum_{i=1}^{p}{w_{i}}}{w_{p+1}}\left(y_{p+1}-y_{p}\right)\)</span>.</p>
</div>
<div class="section level2">
<h2 id="joint-calibration-of-totals-and-quantiles">Joint calibration of totals and quantiles<a class="anchor" aria-label="anchor" href="#joint-calibration-of-totals-and-quantiles"></a>
</h2>
<p>We propose a simple method that jointly calibrates weights for totals
and quantiles. The resulting calibrated weights <span class="math inline">\(w_{k}\)</span> will allow us to retrieve known
population totals and quantiles of auxiliary variables simultaneously.
In the case of a single scalar auxiliary variable <span class="math inline">\(x\)</span>, the final calibration estimator based
on weights <span class="math inline">\(w_{k}\)</span> delivers an exact
population total and quantile for variable <span class="math inline">\(y\)</span> when the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> is exactly linear i.e. when <span class="math inline">\(y_{k}=\beta x_{k}\)</span> for all <span class="math inline">\(k\in U\)</span>.</p>
<p>Let us assume that we are interested in estimating a population total
<span class="math inline">\(\tau_{y}\)</span> and/or quantile <span class="math inline">\(Q_{y,\alpha}\)</span> of order <span class="math inline">\(\alpha\)</span>, where <span class="math inline">\(\alpha \in \left(0,1\right)\)</span> for variable
of interest <span class="math inline">\(y\)</span>. Let <span class="math inline">\(\mathbf{x}_{k}=\left(\begin{smallmatrix}\mathbf{x}_{k}^{\circ}\\1\\\mathbf{x}_{k}^{*}\end{smallmatrix}\right)\)</span>
be a <span class="math inline">\(J+1\)</span>-dimensional vector of
auxiliary variables, where <span class="math inline">\(J=J_{1}+J_{2}\)</span>. We assume that for <span class="math inline">\(J_{1}\)</span> variables a vector of population
totals <span class="math inline">\(\tau_{\mathbf{x}}\)</span> is known
and for <span class="math inline">\(J_{2}\)</span> variables a vector
<span class="math inline">\(\mathbf{Q}_{\mathbf{x},\alpha}\)</span> of
population quantiles is known. In practice it may happen that for the
same auxiliary variable we know its population total and quantile. We do
not require that the complete auxiliary information described by the
vector <span class="math inline">\(\mathbf{x}_{k}\)</span> is known for
all <span class="math inline">\(k\in U\)</span>; however, for some
auxiliary variables unit-population data would be necessary, because
accurate quantiles are not likely to be known from other sources <span class="citation">(<a href="#ref-sarndal2007calibration" role="doc-biblioref">Särndal 2007</a>)</span>.</p>
<p>Our main aim is to find new calibration weights <span class="math inline">\(w_{k}\)</span> which are as close as possible to
original design weights <span class="math inline">\(d_{k}\)</span> and
for some auxiliary variables reproduce known population totals and for
the remaining benchmark variables – reproduce known population quantiles
exactly. In our joint approach we are looking for a vector <span class="math inline">\(\mathbf{w}=\left(w_{1},\ldots,w_{n}\right)^{T}\)</span>
which is a solution of the optimization problem <span class="math inline">\(D\left(\mathbf{d},\mathbf{v}\right)=\sum _{k\in
s}d_{k}\hspace{2pt} G\hspace{0pt}\left(\frac{v_{k}}{d_{k}}\right) \to
\textrm{min}\)</span> subject to the calibration constraints <span class="math inline">\(\sum_{k\in s}v_{k}=N\)</span>, <span class="math inline">\(\sum_{k\in s}v_{k}\mathbf{x}_{k}^{\circ} =
\tau_{\mathbf{x}}\)</span> and <span class="math inline">\(\hat{\mathbf{Q}}_{\mathbf{x},cal,\alpha}=\mathbf{Q}_{\mathbf{x},\alpha}\)</span>.
In general, <span class="math inline">\(J+1\)</span> calibration
equations have to be fulfilled. Alternatively, calibration equations can
be expressed as <span class="math inline">\(\sum_{k\in
s}v_{k}\mathbf{x}_{k}^{\circ} = \tau_{\mathbf{x}}\)</span> and <span class="math inline">\(\sum_{k\in
s}v_{k}\mathbf{a}_{k}=\mathbf{T_{a}}\)</span> with possible boundary
constraints on calibration weights.</p>
<p>Assuming a quadratic metric <span class="math inline">\(D\left(\cdot\right)\)</span>, which is based on
<span class="math inline">\(G\left(x\right)=\frac{\left(x-1\right)^{2}}{2}\)</span>
function, an explicit solution of the above optimization problem can be
derived. This solution is similar to the calibration weights for totals
and quantiles. Let <span class="math inline">\(\mathbf{h}_{\mathbf{x}}=\binom{\tau_{\mathbf{x}}}{\mathbf{T_{a}}}\)</span>
and <span class="math inline">\(\hat{\mathbf{h}}_{\mathbf{x}}=\binom{\sum_{k\in
s}d_{k}\mathbf{x}_{k}^{\circ}}{\sum_{k\in
s}d_{k}\mathbf{a}_{k}}\)</span>. Then the vector of calibration weights
<span class="math inline">\(\mathbf{w}=\left(w_{1},\ldots,w_{n}\right)^{T}\)</span>
which solves the above optimization problem satisfies the relation:</p>
<p><span class="math display">\[\begin{equation}
w_{k}=d_{k}+d_{k}\left(\mathbf{h}_{\mathbf{x}}-\hat{\mathbf{h}}_{\mathbf{x}}\right)^{T}\left(\sum_{j\in
s}{d_{j}}\mathbf{x}_{j}\mathbf{x}_{j}^{T}\right)^{-1}\mathbf{x}_{k}.
\end{equation}\]</span></p>
<p><em>Remark 1</em>: In our proposed method we assume that we reproduce
known population totals and known population quantiles for a set of
benchmark variables simultaneously. This approach can be easily extended
by assuming that for estimated totals or quantiles are reproduced for
some auxiliary variables. Moreover, we assumed that the process of
calibration is based on a particular quantile (of order <span class="math inline">\(\alpha\)</span>). For instance, it could be a
median i.e. <span class="math inline">\(\alpha=0.5\)</span>. Nothing
stands in the way of searching for calibration weights which reproduce
population totals and a set of population quantiles (for example
quartiles) for a chosen set of auxiliary variables. Moreover, the
proposed method can be easily extended for the generalized calibration,
in particular, for not missing at random non-response <span class="citation">(<a href="#ref-kott2010using" role="doc-biblioref">Kott
and Chang 2010</a>)</span>, or empirical likelihood by adding additional
constraints on quantiles, i.e. <span class="math inline">\(\sum_{k \in
s} p_{k}a_{kj} = \frac{\alpha}{N}\)</span>, where <span class="math inline">\(j=1,\ldots,J_{2}\)</span> and <span class="math inline">\(p_{k}\)</span> are elements of the vector <span class="math inline">\(\mathbf{p}=\left(p_{1},\ldots,p_{n}\right)^{T}\)</span>
which is is a discrete probability measure over the sample <span class="math inline">\(s\)</span> <span class="citation">(<a href="#ref-wu2020sampling" role="doc-biblioref">Wu and Thompson
2020</a>)</span>.</p>
<p><em>Remark 2</em>: In our approach we use an interpolated
distribution function <span class="math inline">\(H_{y,s}\)</span>,
which is a simple modification of the Heavyside function defined in
(<span class="math inline">\(\ref{H}\)</span>). From a practical point
of view a smooth approximation to the step function, based on the
logistic function can be used i.e. <span class="math inline">\(H\left(x\right)\approx\frac{1}{2}+\frac{1}{2}\tanh{kx}=\frac{1}{1+e^{-2kx}}\)</span>,
where a larger value of <span class="math inline">\(k\)</span>
corresponds to a sharper transition at <span class="math inline">\(x =
0\)</span>.</p>
<p><em>Remark 3</em>: The proposed method can be easily applied to data
from household surveys, where integrated calibration is applied,
i.e. when the weights of particular household members should be equal.
This can be in particularly useful in the case of EU-SILC, where
information from administrative data can be used to provide population
distributions for auxiliary variables.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-deville1992calibration" class="csl-entry">
Deville, Jean-Claude, and Carl-Erik Särndal. 1992. <span>“Calibration
Estimators in Survey Sampling.”</span> <em>Journal of the American
Statistical Association</em> 87 (418): 376–82.
</div>
<div id="ref-duchesne1999robust" class="csl-entry">
Duchesne, PIERRE. 1999. <span>“Robust Calibration Estimators.”</span>
<em>Survey Methodology</em> 25: 43–56.
</div>
<div id="ref-harms2006calibration" class="csl-entry">
Harms, Torsten, and Pierre Duchesne. 2006. <span>“On Calibration
Estimation for Quantiles.”</span> <em>Survey Methodology</em> 32 (1):
37–52.
</div>
<div id="ref-kott2010using" class="csl-entry">
Kott, Phillip S, and Ted Chang. 2010. <span>“Using Calibration Weighting
to Adjust for Nonignorable Unit Nonresponse.”</span> <em>Journal of the
American Statistical Association</em> 105 (491): 1265–75.
</div>
<div id="ref-sarndal2007calibration" class="csl-entry">
Särndal, Carl-Erik. 2007. <span>“The Calibration Approach in Survey
Theory and Practice.”</span> <em>Survey Methodology</em> 33 (2): 99–119.
</div>
<div id="ref-sarndal2005estimation" class="csl-entry">
Särndal, Carl-Erik, and Sixten Lundström. 2005. <em>Estimation in
Surveys with Nonresponse</em>. John Wiley &amp; Sons.
</div>
<div id="ref-wu2020sampling" class="csl-entry">
Wu, Changbao, and Mary E Thompson. 2020. <em>Sampling Theory and
Practice</em>. Springer.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
